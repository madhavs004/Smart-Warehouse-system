<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Control Panel</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 2em;
      background: linear-gradient(135deg, #eef0e7, #ffffff);
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2em;
    }

    .main-wrapper {
      display: flex;
      flex-direction: row;
      gap: 3em;
      align-items: flex-start;
      justify-content: center;
      flex-wrap: wrap;
    }

    @media (max-width: 768px) {
      .main-wrapper {
        flex-direction: column;
        align-items: center;
      }
    }

    .container {
      background: #ffffff;
      padding: 2em 3em;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      text-align: center;
      max-width: 600px;
      width: 100%;
    }

    .title {
      text-align: center;
      font-size: 2.5em;
      color: #000000;
    }

    h2 {
      font-size: 1.6em;
      margin-bottom: 1em;
      color: #b12451;
    }

    #status {
      margin-top: 1em;
      font-weight: bold;
      color: #d7388a;
      min-height: 1.2em;
    }

    .error {
      color: #fc4561 !important;
    }

    .rack {
      display: grid;
      grid-template-columns: repeat(4, 60px);
      grid-template-rows: repeat(4, 60px);
      gap: 10px;
      justify-content: center;
  align-content: center;
    }

    .cell {
      background-color: #eee;
      border: 1px solid #ccc;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border-radius: 8px;
      transition: background-color 0.3s;
      cursor: pointer;
      user-select: none;
      font-size: 14px;
    }

    .cell span {
      font-size: 10px;
      color: #666;
      margin-top: 4px;
    }

    .cell.active {
      background-color: #ee86cb;
      color: white;
    }

    .rack-label {
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 0.5em;
      font-weight: bold;
    }

    .clear-btn {
      margin-top: 0.1em;
      background-color: #ea6eae;
      color: white;
      border: none;
      padding: 0.7em 1.5em;
      font-size: 1em;
      border-radius: 8px;
      cursor: pointer;
    }

    .clear-btn:hover {
      background-color: #b92e76;
    }
    .cell button {
  background-color: #ddd;
  border: none;
  font-weight: bold;
}

.cell button:hover {
  background-color: #ccc;
}

  </style>
</head>
<body>
  

  <div class="main-wrapper">
    <div class="container">
        <h1 class="title">Smart Warehouse System</h1>
      <h2>Select a cell to reach the position</h2>
      <div class="rack-wrapper">
        <div class="rack" id="rack">
          <!-- Cells generated by JavaScript -->
        </div>
      </div>
    
      <p id="status"></p>
      
      <button class="clear-btn" id="clearBtn">Reset Count</button>
    </div>
    </div>

   

    <script>
      const rack = document.getElementById('rack');
      const statusEl = document.getElementById('status');
      const clearBtn = document.getElementById('clearBtn');
    
      const clickCounts = {};
    
      for (let r = 1; r <= 4; r++) {
        for (let c = 1; c <= 4; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.id = `cell-${r}-${c}`;
          cell.dataset.row = r;
          cell.dataset.col = c;
    
          const key = `${r}-${c}`;
          clickCounts[key] = 0;
    
          const label = document.createElement('div');
          label.textContent = `${r},${c}`;
    
          const counter = document.createElement('span');
          counter.id = `count-${key}`;
          counter.textContent = 'Items: 0';
    
          // Tiny + and - buttons
          const controls = document.createElement('div');
          controls.style.display = 'flex';
          controls.style.gap = '3px';
          controls.style.marginTop = '4px';
    
          const plusBtn = document.createElement('button');
          plusBtn.textContent = '+';
          plusBtn.style.padding = '2px 6px';
          plusBtn.style.fontSize = '10px';
          plusBtn.style.cursor = 'pointer';
          plusBtn.style.borderRadius = '4px';
    
          const minusBtn = document.createElement('button');
          minusBtn.textContent = 'â€“';
          minusBtn.style.padding = '2px 6px';
          minusBtn.style.fontSize = '10px';
          minusBtn.style.cursor = 'pointer';
          minusBtn.style.borderRadius = '4px';
    
          plusBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // prevent cell click
            clickCounts[key]++;
            counter.textContent = `Items: ${clickCounts[key]}`;
            statusEl.innerText = `Item added to cell ${r},${c}`;
            statusEl.classList.remove('error');
          });
    
          minusBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // prevent cell click
            if (clickCounts[key] > 0) {
              clickCounts[key]--;
              counter.textContent = `Items: ${clickCounts[key]}`;
              statusEl.innerText = `Item removed from cell ${r},${c}`;
              statusEl.classList.remove('error');
            } else {
              statusEl.innerText = `No items to remove in cell ${r},${c}`;
              statusEl.classList.add('error');
            }
          });
    
          controls.appendChild(plusBtn);
          controls.appendChild(minusBtn);
    
          cell.appendChild(label);
          cell.appendChild(counter);
          cell.appendChild(controls);
    
          cell.addEventListener('click', () => {
            document.querySelectorAll('.cell.active').forEach(c => c.classList.remove('active'));
            cell.classList.add('active');
    
            fetch(`/send?row=${r}&col=${c}`)
              .then(res => res.text())
              .then(data => {
                statusEl.innerText = `Sent position ${r},${c} to ESP32!`;
                statusEl.classList.remove('error');
              })
              .catch(err => {
                statusEl.innerText = 'Failed to send!';
                statusEl.classList.add('error');
              });
          });
    
          rack.appendChild(cell);
        }
      }
    
      clearBtn.addEventListener('click', () => {
        for (let r = 1; r <= 4; r++) {
          for (let c = 1; c <= 4; c++) {
            const key = `${r}-${c}`;
            clickCounts[key] = 0;
            const counter = document.getElementById(`count-${key}`);
            if (counter) counter.textContent = 'Items: 0';
          }
        }
    
        document.querySelectorAll('.cell.active').forEach(c => c.classList.remove('active'));
        statusEl.innerText = '';
      });
    </script>
    
</body>
</html>
